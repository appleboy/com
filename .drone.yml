---
kind: pipeline
name: default

platform:
  os: linux
  arch: amd64

steps:
- name: test
  pull: always
  image: golang:1.11
  commands:
  - make vet
  - make lint
  - make test

- name: codecov
  pull: default
  image: robertstettner/drone-codecov
  settings:
    files:
    - coverage.out
    group: build
  environment:
    CODECOV_TOKEN:
      from_secret: codecov_token

- name: discord
  pull: always
  image: appleboy/drone-discord
  environment:
    DISCORD_WEBHOOK_ID:
      from_secret: discord_webhook_id
    DISCORD_WEBHOOK_TOKEN:
      from_secret: discord_webhook_token
  when:
    status:
    - changed
    - failure

...
